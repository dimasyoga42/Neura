name: Update Readme from README

on:
push:
paths:
- "README.md"
- ".github/workflows/update-readme.yml"

jobs:
update-readme:
runs-on: ubuntu-latest

```
steps:
  - name: Checkout repo (full history)
    uses: actions/checkout@v4
    with:
      fetch-depth: 0

  - name: Generate Commit List
    run: |
      echo "## update" > commits.md
      echo "" >> commits.md
      git log -10 --pretty=format:"- %s (%h)" >> commits.md
      echo "" >> commits.md

  - name: Insert Commits into README (under ## update)
    run: |
      if [ ! -f README.md ]; then
        echo "# Project" > README.md
        echo "" >> README.md
        echo "## Changelog" >> README.md
        echo "" >> README.md
        echo "## update" >> README.md
        echo "" >> README.md
      fi

      # Hapus isi lama setelah ## update
      sed -i '/## update/,$d' README.md

      # Tambahkan kembali header update + commit terbaru
      cat commits.md >> README.md

      rm commits.md

  - name: Commit changes
    run: |
      git config user.name "github-actions"
      git config user.email "actions@github.com"

      git add README.md
      git diff --cached --quiet || git commit -m "auto update README (recent commits)"

  - name: Push changes
    uses: ad-m/github-push-action@master
    with:
      github_token: ${{ secrets.GITHUB_TOKEN }}
```
